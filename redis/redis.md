## 1.什么是COW?
Copy-On-Write 是一种优化技术，主要用于内存管理。它的基本思想是，如果多个进程需要读取相同的数据，那么它们可以共享同一块内存，直到其中一个进程需要修改这块内存中的数据时，才会真正复制一份新的数据块给这个进程。这样可以节省内存资源，提高效率。

redis在备份过程中会用到这种技术。

### RDB 备份过程
当 Redis 开始进行 RDB 备份时，Redis 进程会使用 fork 系统调用创建一个子进程。
这个子进程负责执行备份操作。
在 fork 之后，父进程和子进程会共享相同的内存数据。
只有当父进程或子进程尝试修改共享数据时，才会触发 COW 机制，复制一份新的数据块。

### 内存占用问题
如果 Redis 进程在备份期间更新 key 的速度非常快，那么会频繁触发 COW 机制。
这会导致内存占用急剧增加，极端情况下可能会占用存储空间的两倍。

注意：
在 Copy-On-Write (COW) 机制下，当父进程或子进程修改某个内存页时，操作系统只会复制被修改的那个内存页，而不是整个内存。这种方式极大地提高了内存使用效率。



